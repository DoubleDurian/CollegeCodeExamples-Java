/*
 * Program:Poker
 * This:Table.java
 * Author:Nicholas Johnston
 * Date:4/23/2016
 * Purpose:To facilitate the game
 */
package poker;
import java.util.Scanner;

public class Table 
{
    //variable
    Deck deck;//holds a newly shuffled deck
    Hand player;//holds the cards of the player
    Hand house;//holds the cards of the house
    int swapsLeft = 3;
    int choice;
    Scanner scan = new Scanner(System.in);
    //methods
    public void run()
    {
        int wins =0;
        for(int i =0;i<3;i++)
        {
            if(playaHand())
            {
                wins++;
            }
        }
        System.out.println("You won " + wins + " out of three hands");
        
    }
    boolean playaHand()
    {//runs the game
        //instance new deck
        deck = new Deck();
        player = new Hand();
        house = new Hand();
        System.out.println(stringStart());
        //deal the new hand to the player and the house
        for(int i=0; i<5;i++)
        {
            player.insert(deck.draw());
            house.insert(deck.draw());
        }
        //======display the card and player choices
        //=======menu layer 0ne=========================
        choiceLayer();
        //==============================================
        //=================menu layer 2================
        swapLayer();
        //=============================================
        //================menu layer 3=================
        
        
         System.out.println( "================================================================================\n"
              +"================================================================================\n"
              +"                                    Player                                      \n"
              +"================================================================================\n"
              +"================================================================================\n" );
        System.out.println(player.format()); 
        printHand(player);
         System.out.println( "================================================================================\n"
              +"================================================================================\n"
              +"                                    House                                      \n"
              +"================================================================================\n"
              +"================================================================================\n" );
         System.out.println(house.format());
         printHand(house);
         if(player.rankingDetect() ==1&&house.rankingDetect()==1)
         {
             return (player.highCard()>house.highCard());
         }
         if(player.rankingDetect() > house.rankingDetect())
         {
             System.out.println("YOU WIN!!!!!!!!");
             return true;
         }
         else
         {
             System.out.println("CRITICAL FALIURE!!!!");
             return false;
         }
        //=============================================
        
        
        
        
    }
    public String stringStart()
    {
        return "Welcome to Poker\nTry your luck at a hand";
    }
    public String stringBorder()
    {
        return "================================================================================\n"
              +"================================================================================\n"
              +"                                    PLAYER TURN!                                \n"
              +"================================================================================\n"
              +"================================================================================\n";
             
    }
    public String stringOptions()
    {
        return "================================================================================\n"
              +"================================================================================\n"
              +"      1                2                3                4                5     \n"
              +"================================================================================\n"
              +"================================================================================\n";
    }
    public String holdOrSwap()
    {
        return "================================================================================\n"
              +"================================================================================\n"
              +"      1:Hold                       or                     2:Swap                \n"
              +"================================================================================\n"
              +"================================================================================\n";
    }
    public void printHand(Hand player)
    {
        int rank=player.rankingDetect();
        //System.out.println(rank);
        switch(rank)
        {
            case 10:
               System.out.println( "================================================================================\n"
              +"================================================================================\n"
              +"                                    Royal Flush!                                \n"
              +"================================================================================\n"
              +"================================================================================\n" );
                break;
            case 9:
                 System.out.println( "================================================================================\n"
              +"================================================================================\n"
              +"                                    Straight Flush!                                \n"
              +"================================================================================\n"
              +"================================================================================\n" );
                break;
            case 8:
                 System.out.println( "================================================================================\n"
              +"================================================================================\n"
              +"                                    Four of a Kind!                                \n"
              +"================================================================================\n"
              +"================================================================================\n" );
                break;
            case 7:
                 System.out.println( "================================================================================\n"
              +"================================================================================\n"
              +"                                    Full House!                                \n"
              +"================================================================================\n"
              +"================================================================================\n" );
                break;
            case 6:
                 System.out.println( "================================================================================\n"
              +"================================================================================\n"
              +"                                    Flush!                                \n"
              +"================================================================================\n"
              +"================================================================================\n" );
                break;
            case 5:
                 System.out.println( "================================================================================\n"
              +"================================================================================\n"
              +"                                    Straight!                                \n"
              +"================================================================================\n"
              +"================================================================================\n" );
                break;
            case 4:
                 System.out.println( "================================================================================\n"
              +"================================================================================\n"
              +"                                    Three of a Kind!                                \n"
              +"================================================================================\n"
              +"================================================================================\n" );
                break;
            case 3:
                 System.out.println( "================================================================================\n"
              +"================================================================================\n"
              +"                                    Two Pair !                                \n"
              +"================================================================================\n"
              +"================================================================================\n" );
                break;
            case 2:
                 System.out.println( "================================================================================\n"
              +"================================================================================\n"
              +"                                    Pair!                                       \n"
              +"================================================================================\n"
              +"================================================================================\n" );
                break;
            case 1:
                 System.out.println( "================================================================================\n"
              +"================================================================================\n"
              +"                                    High Card of "+player.highCard() +"!                         \n"
              +"================================================================================\n"
              +"================================================================================\n" );
                break;
        }
    
    }
    
    public void getChoice()
    {
        while(!scan.hasNextInt())
        {
            System.out.println("Please enter an integer");
            scan.nextLine();
        }
        choice = scan.nextInt();
    }
    public void drawNew(int index)
    {
        Card newCard = new Card(deck.draw());
        player.handStack[index-1] = newCard;
    }
    public void choiceLayer()
    {//holds the part of the menu that asks the player to choose to hold or swap
        System.out.println(stringBorder());
        
        System.out.println(player.format());
        printHand(player);
        System.out.println(holdOrSwap());
        
        //create variables for while loop
        boolean legit = true;
        while(legit)
        {
            System.out.println("Please enter an integer 1 or 2");
            getChoice();
            if(choice == 1 || choice ==2)
            {
                legit = false;
            }
        }
    }
    public void swapLayer()
    {//asks the player which card to swap and if they what to swap again
        //uses recursion three times max.
        if(choice == 2&&swapsLeft!=0)
        {
            System.out.println("================================================================================\n"
              +"================================================================================\n"
              +"                                    SELECT CARDS!                               \n"
              +"================================================================================\n"
              +"================================================================================\n");
            System.out.println(player.format());
            System.out.println(stringOptions());
            System.out.println("You have "+ swapsLeft + " swaps left.\nWhat card will you swap?");
            boolean hasCard = true;
            while(hasCard)
            {
                System.out.println("Please enter an integer 1 through 5");
                getChoice();
                if(choice == 1 || choice ==2||choice ==3||choice ==4||choice ==5)
                {
                    hasCard = false;
                }
            }
            drawNew(choice);
            swapsLeft--;
            choiceLayer();
            swapLayer();
        }
        else
        {
            System.out.println("Sorry, you are out of swaps, no more card trading for you");
        }
    }
    
}
